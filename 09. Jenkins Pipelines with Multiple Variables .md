# ğŸ“š **Jenkins Declarative Pipelines with Multiple Variables** ğŸš€

---

# **1. Introduction** ğŸ“

This SOP explains how to use **multiple variables** inside Jenkins Declarative Pipelines, including:

* ğŸŒ Global environment variables
* ğŸƒ Stage-specific environment variables
* ğŸ§‘â€ğŸ’» Script block variables
* âš¡ Pipeline parameters
* ğŸ¤– Jenkins built-in environment variables

---

# **2. Key Concepts** ğŸ”‘

| Concept                           | Explanation                                    |
| --------------------------------- | ---------------------------------------------- |
| ğŸŒ **Global Env Vars**            | User-defined variables available pipeline-wide |
| ğŸƒ **Stage Env Vars**             | Variables limited to a specific stage          |
| ğŸ§‘â€ğŸ’» **Script Vars**             | Variables inside `script {}` only              |
| âš¡ **Pipeline Parameters**         | User-input values at runtime                   |
| ğŸ¤– **Jenkins Built-In Variables** | Auto-provided by Jenkins          |

---

# **3. Jenkins Built-In Environment Variables ** ğŸ¤–

These variables are **provided automatically** by Jenkins.
You **do NOT declare them**, you just use them.

| Variable        | Meaning                  | Emoji |
| --------------- | ------------------------ | ----- |
| `BUILD_NUMBER`  | Current build number     | ğŸ”¢    |
| `BUILD_ID`      | Timestamp build ID       | ğŸ†”    |
| `BUILD_URL`     | URL of the build         | ğŸŒ    |
| `JOB_NAME`      | Full job name            | ğŸ·ï¸   |
| `JOB_BASE_NAME` | Job name without folder  | ğŸ“‚    |
| `WORKSPACE`     | Workspace directory path | ğŸ“    |
| `NODE_NAME`     | Agent executing the job  | ğŸ¤–    |
| `JENKINS_URL`   | Jenkins server URL       | ğŸ     |
| `BRANCH_NAME`   | Git branch name          | ğŸŒ¿    |
| `GIT_COMMIT`    | Latest commit hash       | ğŸ§¬    |
| `CHANGE_ID`     | PR/MR ID                 | ğŸ”€    |

---

# **4. Updated Tree Diagram Including Built-In Vars** ğŸŒ³

```
Jenkins Pipeline ğŸŒŸ
 â”œâ”€â”€ Global Environment Variables ğŸŒ
 â”‚   â”œâ”€â”€ APP_NAME
 â”‚   â”œâ”€â”€ BUILD_TYPE
 â”‚   â””â”€â”€ GLOBAL_PATH
 â”‚
 â”œâ”€â”€ Jenkins Built-In Variables ğŸ¤–
 â”‚   â”œâ”€â”€ BUILD_NUMBER
 â”‚   â”œâ”€â”€ JOB_NAME
 â”‚   â”œâ”€â”€ WORKSPACE
 â”‚   â”œâ”€â”€ BRANCH_NAME
 â”‚   â””â”€â”€ GIT_COMMIT
 â”‚
 â”œâ”€â”€ Stage Environment Variables ğŸƒâ€â™€ï¸
 â”‚   â”œâ”€â”€ BUILD_DIR
 â”‚   â””â”€â”€ TEST_TYPE
 â”‚
 â”œâ”€â”€ Script Variables ğŸ§‘â€ğŸ’»
 â”‚   â”œâ”€â”€ buildVersion
 â”‚   â””â”€â”€ deployPath
 â”‚
 â””â”€â”€ Pipeline Parameters âš¡
     â”œâ”€â”€ USERNAME
     â””â”€â”€ DEPLOY_ENV
```

---

# **5. Workflow Chart (Enhanced)** ğŸ“Š

```
Start â†’ Global Env Vars ğŸŒ â†’ Jenkins Built-In Vars ğŸ¤– â†’ User Params âš¡ â†’ Build Stage ğŸ”¨  
  â†“                               â†“                    â†“
Stage Vars ğŸƒâ€â™€ï¸                Always Available      Passed into Stages
  â†“                               â†“                    â†“
Test Stage ğŸ§ª â† Script Vars ğŸ§‘â€ğŸ’» â† Deploy Stage ğŸš€  
  â†“
Finish âœ…
```

---

# **6. Full Example Pipeline (Updated with Jenkins Built-In Vars)** ğŸ’»

```groovy
pipeline {
    agent any

    // ğŸŒ Global Environment Variables
    environment {
        APP_NAME = "MyWebApp"
        BUILD_TYPE = "Release"
        GLOBAL_PATH = "/opt/apps"
    }

    // âš¡ User Parameters
    parameters {
        string(name: 'USERNAME', defaultValue: 'admin')
        choice(name: 'DEPLOY_ENV', choices: ['dev', 'qa', 'prod'])
    }

    stages {

        stage('Jenkins Built-In Vars Info') {
            steps {
                echo "ğŸ”¢ BUILD_NUMBER: ${BUILD_NUMBER}"       // Jenkins built-in
                echo "ğŸ“ WORKSPACE: ${WORKSPACE}"             // Jenkins built-in
                echo "ğŸ·ï¸ JOB_NAME: ${JOB_NAME}"               // Jenkins built-in
            }
        }

        // ğŸ”¨ Build Stage
        stage('Build') {
            environment {
                BUILD_DIR = "/tmp/build"   // ğŸƒ Stage-specific Env Variable
            }
            steps {
                script {
                    def buildVersion = "v1.0" // ğŸ§‘â€ğŸ’» Script variable
                    echo "Building ${APP_NAME} version ${buildVersion}"
                    echo "Build Directory: ${BUILD_DIR}"
                }
            }
        }

        // ğŸ§ª Test Stage
        stage('Test') {
            environment {
                TEST_TYPE = "Integration"  // Stage env var
            }
            steps {
                script {
                    def testResult = "Success" // Script variable
                    echo "Running ${TEST_TYPE} tests in ${WORKSPACE}"
                    echo "Test Result: ${testResult}"
                }
            }
        }

        // ğŸš€ Deploy Stage
        stage('Deploy') {
            steps {
                script {
                    def deployPath = "${GLOBAL_PATH}/${APP_NAME}/${params.DEPLOY_ENV}"
                    echo "Deploying to: ${deployPath}"
                    echo "Executor Used: ${EXECUTOR_NUMBER}"   // Built-in
                    echo "Node Running: ${NODE_NAME}"          // Built-in
                }
            }
        }
    }

    post {
        always {
            echo "Pipeline completed for ${APP_NAME} â€“ Build #${BUILD_NUMBER}"
        }
    }
}
```

---

# **7. Troubleshooting Tips** ğŸ› ï¸

### ğŸ”¥ Built-in variable shows blank?

* Some vars exist only in **Multibranch Pipelines** (ex: `BRANCH_NAME`)
* Some require proper SCM setup (ex: `GIT_COMMIT`)

### âš ï¸ â€œVariable not foundâ€?

Check if it's:

* ğŸŒ Global
* ğŸƒ Stage-specific
* ğŸ§‘â€ğŸ’» Script-only
* ğŸ¤– Jenkins built-in
* âš¡ Parameter

Scopes **do not overlap**.

---

# **8. Key Takeaways** ğŸ—ï¸

âœ” Jenkins gives you **built-in env vars automatically**
âœ” You declare **your own env vars** in the pipeline
âœ” Stage env vars override global ones
âœ” Script vars are local only
âœ” Params come from user input

---
