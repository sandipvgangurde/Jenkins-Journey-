```groovy

pipeline {
    agent any  // Run this pipeline on any available agent

    stages {

        /* -------------------------------------------------------
         * Stage: Build Docker Image
         * -------------------------------------------------------
         * This stage demonstrates:
         *   - Running multiple shell commands
         *   - Retry strategy for flaky steps
         *   - Timeout protection
         *   - Clear separation of build steps
         * ------------------------------------------------------- */
        stage("Build Docker Image") {
            steps {

                // Step 1: Basic echo and environment info
                echo "Starting Docker build process"
                sh 'pwd'               // Show current directory
                sh 'ls -la'            // List all files in workspace

                // Step 2: Retry strategy for docker-related commands
                script {
                    echo "Retrying Docker commands if they fail"

                    retry(3) {  // Retry up to 3 times if any command fails

                        // Timeout: prevent hanging indefinitely
                        timeout(time: 2, unit: "MINUTES") {

                            echo "Listing Docker images"
                            sh 'docker images'  // List images

                            echo "Building Docker image"
                            sh 'docker build -t my-app:latest .'  // Docker build

                            echo "Docker image built successfully"

                            echo "Optional: Remove dangling images"
                            sh 'docker image prune -f'  // Clean up unused images

                        } // end timeout
                    } // end retry
                } // end script
            } // end steps

            /* ---------------------------------------------------
             * Post actions for stage-level feedback
             * --------------------------------------------------- */
            post {
                success {
                    echo "Build stage completed successfully"
                }
                failure {
                    echo "Build stage failed even after retries"
                }
                aborted {
                    echo "Build stage aborted (timeout likely exceeded)"
                }
            }
        } // end stage

    } // end stages
} // end pipeline
